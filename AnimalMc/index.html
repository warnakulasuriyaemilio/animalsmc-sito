<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ANIMALSMC - Network Italiano</title>
    <script type="text/javascript" src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&family=Poppins:wght@400;600;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        :root {
            --primary: #4CAF50;        
            --accent: #FFD700;        
            --discord: #5865F2;        
            --glass-dark: rgba(0, 0, 0, 0.7); 
            --glass-light: rgba(255, 255, 255, 0.15); 
            --border: 1px solid rgba(255, 255, 255, 0.1); 
            --text: #ffffff;
            --error: #ff5555;
            
            /* Colori Ruoli */
            --owner: #ff5555; 
            --manager: #9C27B0; 
            --sradmin: #00AA00; 
            --admin: #55FF55; 
            --jrdev: #00B0FF; --jrmod: #00E5FF; --helper: #2E7D32; --trainee: #FFCA28;
        }
        * { box-sizing: border-box; margin: 0; padding: 0; }
        
        html, body { width: 100%; max-width: 100%; overflow-x: hidden; }

        body {
            font-family: 'Poppins', sans-serif; background-color: #111;
            background-image: url('https://copilot.microsoft.com/th/id/BCO.507feaa8-8039-430f-bffe-a635988f1204.png');
            background-size: cover; background-attachment: fixed; background-position: center;
            color: var(--text); padding-top: 80px; min-height: 100vh;
            display: flex; flex-direction: column;
        }

        /* --- NUOVO STILE NAVIGAZIONE (Dark Glass) --- */
        nav {
            position: fixed; top: 0; width: 100%; z-index: 1000;
            background: rgba(0, 0, 0, 0.85); /* Sfondo scuro semitrasparente */
            backdrop-filter: blur(15px);      /* Effetto sfocatura dietro */
            -webkit-backdrop-filter: blur(15px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1); /* Bordo sottile */
            padding: 0 20px; height: 70px;
            display: flex; align-items: center; justify-content: space-between;
            box-shadow: 0 4px 20px rgba(0,0,0,0.4);
        }

        .nav-left { display: flex; align-items: center; }
        .nav-logo-img {
            height: 45px; width: auto;
            filter: drop-shadow(0 0 5px rgba(255,255,255,0.2));
            transition: transform 0.3s; margin: 0 10px;
        }
        .nav-logo-img:hover { transform: scale(1.1) rotate(-5deg); }
        .nav-brand-text { font-size: 1.2rem; color: white; letter-spacing: 1px; display: inline-block; }

        .user-display { display: none; align-items: center; gap: 10px; background: rgba(255,255,255,0.1); padding: 5px 15px; border-radius: 20px; color: white; font-weight: bold; border: 1px solid rgba(255,255,255,0.2); font-size: 0.9rem;}
        
        .nav-links { display: flex; gap: 5px; align-items: center; height: 100%; }
        
        /* Nuovi Bottoni Menu Minimal */
        .nav-btn {
            background: transparent; /* Sfondo trasparente di base */
            border: none; font-weight: 600; color: #ccc; 
            padding: 8px 14px; border-radius: 8px; 
            cursor: pointer; transition: 0.3s; font-size: 0.85rem; text-transform: uppercase; 
            display: flex; align-items: center; gap: 8px;
        }
        .nav-btn:hover { background: rgba(255,255,255,0.1); color: white; }
        .nav-btn.active { background: var(--primary); color: white; box-shadow: 0 0 15px rgba(76, 175, 80, 0.4); }
        
        /* Bottoni Speciali (Discord/Register/Login) */
        .btn-discord-nav { background: rgba(88, 101, 242, 0.2) !important; color: #5865F2 !important; border: 1px solid rgba(88, 101, 242, 0.5); }
        .btn-discord-nav:hover { background: #5865F2 !important; color: white !important; }
        
        .btn-reg-nav { background: rgba(255, 215, 0, 0.1) !important; color: var(--accent) !important; border: 1px solid var(--accent); }
        .btn-reg-nav:hover { background: var(--accent) !important; color: #000 !important; }

        .menu-toggle { display: none; font-size: 1.5rem; color: white; cursor: pointer; background: none; border: none; }

        h1, h2, h3, .pixel-font { font-family: 'Press Start 2P', cursive; text-transform: uppercase; color: white; text-shadow: 2px 2px 0 #000; line-height: 1.5; }
        
        .main-content { flex: 1; width: 100%; }
        .page { display: none; width: 100%; max-width: 1100px; margin: 0 auto; padding: 20px; animation: fadeIn 0.4s; }
        .page.active { display: block; }
        @keyframes fadeIn { from {opacity:0; transform:translateY(10px);} to {opacity:1; transform:translateY(0);} }
        
        .panel { background: var(--glass-dark); border-radius: 20px; padding: 30px; border: var(--border); text-align: center; backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px); width: 100%; }
        .transparent-panel { background: transparent; border: none; text-align: center; padding: 20px; width: 100%; display: flex; flex-direction: column; align-items: center;}
        
        .clean-grid, .forum-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 20px; margin-top: 30px; }
        .item-card, .forum-card { background: var(--glass-light); border: var(--border); padding: 20px; border-radius: 15px; transition: 0.3s; color: white; display: flex; flex-direction: column; align-items: center; justify-content: center; text-align: center; }
        .item-card:hover, .forum-card:hover { background: rgba(255,255,255,0.25); border-color: var(--primary); transform: translateY(-3px); cursor: pointer; }
        
        /* FORM STYLES */
        input, textarea, select { width: 100%; padding: 12px; background: rgba(0, 0, 0, 0.4); border: 1px solid rgba(255,255,255,0.3); border-radius: 10px; margin-bottom: 10px; font-family: 'Poppins'; color: white; font-size: 1rem; }
        select option { background-color: #333; color: white; }
        
        .btn-action { 
            background: linear-gradient(to bottom, #FFCA28, #FFB300); color: white; 
            font-family: 'Press Start 2P'; font-size: 0.8rem; padding: 12px 20px; 
            border: none; border-radius: 10px; cursor: pointer; border-bottom: 4px solid #F57F17; 
            width: 100%; margin-top: 10px; word-wrap: break-word; 
        }
        
        .server-status-box { background: rgba(0,0,0,0.6); border: 1px solid rgba(255,255,255,0.3); border-radius: 15px; padding: 20px; margin-top: 30px; width: 100%; max-width: 400px; backdrop-filter: blur(5px); }
        .status-indicator { display: inline-block; width: 12px; height: 12px; border-radius: 50%; margin-right: 8px; }
        .status-online { background-color: #4CAF50; box-shadow: 0 0 10px #4CAF50; }
        .status-offline { background-color: #ff5555; box-shadow: 0 0 10px #ff5555; }
        .staff-img { width: 80px; border-radius: 15px; margin-bottom: 10px; box-shadow: 0 5px 15px rgba(0,0,0,0.5); }
        
        /* Regole Style */
        .rules-category { margin-bottom: 30px; text-align: left; background: rgba(255,255,255,0.05); padding: 20px; border-radius: 15px; border: 1px solid rgba(255,255,255,0.1); }
        .rules-category h3 { color: var(--accent); font-size: 1.1rem; border-bottom: 2px solid rgba(255,255,255,0.1); padding-bottom: 10px; margin-bottom: 15px; display: flex; align-items: center; gap: 10px; }
        .rule-item { display: flex; gap: 15px; margin-bottom: 12px; font-size: 0.95rem; line-height: 1.5; align-items: center; }
        .rule-icon { color: var(--primary); min-width: 25px; text-align: center; }

        .site-footer { text-align: center; padding: 20px 0; color: rgba(255,255,255,0.3); font-size: 0.7rem; margin-top: 40px; width: 100%; }
        #leaves-container { position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 9999; overflow: hidden; }
        .real-leaf { position: absolute; top: -50px; font-size: 24px; opacity: 0.9; }
        @keyframes leafFall { 0% { opacity: 0; transform: translateY(-50px) rotate(0deg); } 20% { opacity: 1; } 100% { transform: translateY(100vh) rotate(360deg); opacity: 0; } }

        @media (max-width: 900px) {
            nav { padding: 0 15px; height: 60px; background: #000 !important; /* Mobile nero solido per leggibilit√† */ }
            .menu-toggle { display: block; }
            .nav-links { display: none; position: absolute; top: 60px; left: 0; width: 100%; background: rgba(10,10,10,0.95); flex-direction: column; padding: 20px; height: auto; border-bottom: 1px solid rgba(255,255,255,0.1); backdrop-filter: blur(10px); }
            .nav-links.mobile-active { display: flex; }
            .nav-btn { width: 100%; justify-content: center; padding: 15px; margin-bottom: 8px; font-size: 1rem; border-radius: 10px; }
            .nav-btn:hover { background: rgba(255,255,255,0.1); }
            h1, h2 { font-size: 1.3rem; }
            .panel { padding: 20px 15px; }
            #home-logo { max-width: 70%; }
        }
        @media (max-width: 600px) {
            .btn-action { font-size: 0.7rem !important; padding: 10px 5px !important; max-width: 90% !important; }
            #home-logo { width: 85% !important; }
            .transparent-panel { padding: 10px; width: 100%; overflow: hidden; }
            .nav-logo-img { height: 35px; margin: 0 5px; }
            .nav-brand-text { font-size: 1rem; }
        }
    </style>
</head>
<body>
    <div id="leaves-container"></div>

    <nav>
        <div class="nav-left">
            <div class="user-display" id="nav-user-display">
                <img src="" id="nav-user-head" style="width: 25px; border-radius: 5px;">
                <span id="nav-username">Player</span>
            </div>
            <img src="https://cdn.discordapp.com/attachments/1449414161422614738/1457700911379120280/animalmc_1_1-removebg-preview_1.png?ex=695cf544&is=695ba3c4&hm=d68e45cc4e8fe6b433c0350688146216ad2a65a4073117fdb81d5a2d0fac6074&" alt="AnimalsMC Logo Mini" class="nav-logo-img">
            <span class="nav-brand-text pixel-font">AMC</span>
        </div>
        
        <button class="menu-toggle" onclick="toggleMenu()"><i class="fas fa-bars"></i></button>
        <div class="nav-links" id="nav-links">
            <button class="nav-btn active" onclick="nav('home')" id="n-home"><i class="fas fa-home"></i> Home</button>
            <button class="nav-btn" onclick="nav('store')" id="n-store"><i class="fas fa-shopping-cart"></i> Store</button>
            <button class="nav-btn" onclick="nav('coins')" id="n-coins"><i class="fas fa-coins"></i> Coins</button>
            <button class="nav-btn" onclick="nav('forum')" id="n-forum"><i class="fas fa-comments"></i> Forum</button>
            <button class="nav-btn" onclick="nav('staff')" id="n-staff"><i class="fas fa-users"></i> Staff</button>
            <button class="nav-btn" onclick="nav('rules')" id="n-rules"><i class="fas fa-book"></i> Regole</button>
            <button class="nav-btn btn-discord-nav" onclick="nav('discord')" id="n-discord"><i class="fab fa-discord"></i> Discord</button>
            <button class="nav-btn btn-reg-nav" onclick="netlifyIdentity.open('signup')" id="n-register"><i class="fas fa-user-plus"></i> Registrati</button>
            <button class="nav-btn" onclick="netlifyIdentity.open('login')" id="n-login"><i class="fas fa-sign-in-alt"></i> Login</button>
            <button class="nav-btn btn-logout" onclick="netlifyIdentity.logout()" id="n-logout" style="background:var(--error); color:white;"><i class="fas fa-sign-out-alt"></i> Logout</button>
        </div>
    </nav>

    <div class="main-content">
        <div id="p-home" class="page active">
            <div class="transparent-panel" style="min-height: 65vh; justify-content: center;">
                <img id="home-logo" src="https://cdn.discordapp.com/attachments/1449414161422614738/1457700911379120280/animalmc_1_1-removebg-preview_1.png?ex=695cf544&is=695ba3c4&hm=d68e45cc4e8fe6b433c0350688146216ad2a65a4073117fdb81d5a2d0fac6074&" style="max-width: 450px; width: 90%; animation: float 3s infinite ease-in-out;">
                <style>@keyframes float{0%,100%{transform:translateY(0)}50%{transform:translateY(-15px)}}</style>
                <button class="btn-action" onclick="copyIp()" style="margin-top: 30px; max-width: 300px;">
                    PLAY.ANIMALSMC.IT
                    <div style="font-size: 0.6em; font-family: 'Poppins'; margin-top: 5px; opacity: 0.8; text-transform:none;">Clicca per copiare IP</div>
                </button>
                <div class="server-status-box">
                    <h3 style="margin-bottom: 10px; font-size: 0.9rem;">STATO SERVER</h3>
                    <div id="status-container">
                        <span id="status-dot" class="status-indicator status-offline"></span>
                        <span id="server-status-text" style="font-weight: bold; font-family: 'Press Start 2P'; font-size: 0.8rem;">OFFLINE</span>
                    </div>
                    <p style="margin-top: 8px; color: #ccc; font-size: 0.9rem;">Online: <span id="player-count" style="color: white; font-weight: bold;">0</span></p>
                </div>
            </div>
        </div>

        <div id="p-store" class="page">
            <div class="panel">
                <h2>MARKETPLACE</h2>
                <p id="store-status" style="font-size: 0.9rem; color: #aaa;">Accedi per comprare.</p>
                <div class="clean-grid" id="store-grid"></div>
            </div>
        </div>

        <div id="p-coins" class="page">
            <div class="panel">
                <h2>PROFILO & COINS</h2>
                <input type="text" id="coin-user" placeholder="Nickname..." style="text-align: center; max-width: 400px;">
                <button class="btn-action" onclick="checkCoins()" style="max-width: 300px;">CERCA</button>
                <div id="coin-result" style="display:none; background:rgba(0,0,0,0.5); border:2px solid var(--accent); border-radius:20px; padding:20px; margin-top:20px;">
                    <img id="coin-skin" src="" style="width:70px; border-radius:10px;">
                    <h3 id="coin-name" style="margin: 10px 0; font-size: 1.2rem;"></h3>
                    <div style="font-size:1.8rem; color:#F57F17;"><span id="coin-amount">0</span> üí∞</div>
                </div>
            </div>
        </div>

        <div id="p-forum" class="page">
            <div class="panel" id="forum-hub">
                <h2>FORUM</h2>
                <p style="color: #ccc; font-size: 0.9rem; margin-bottom: 20px;">Seleziona una sezione per continuare</p>
                <div class="forum-grid">
                    <div class="forum-card" onclick="openForum('apply')" style="border-color: var(--accent);">
                        <i class="fas fa-file-signature fa-3x" style="color: var(--accent); margin-bottom: 10px;"></i>
                        <h3 style="color: var(--accent);">CANDIDATURE</h3>
                        <p style="font-size: 0.8rem; color: #ddd;">Vuoi diventare Staff?</p>
                    </div>

                    <div class="forum-card" onclick="openForum('report')" style="border-color: var(--error);">
                        <i class="fas fa-gavel fa-3x" style="color: var(--error); margin-bottom: 10px;"></i>
                        <h3 style="color: var(--error);">SEGNALAZIONI</h3>
                        <p style="font-size: 0.8rem; color: #ddd;">Reporta un cheater</p>
                    </div>

                    <div class="forum-card" onclick="openForum('news')">
                        <i class="fas fa-bullhorn fa-2x"></i><h3>NEWS</h3>
                    </div>
                </div>
            </div>

            <div id="sub-apply" class="sub-forum page" style="background: var(--glass-dark); border-radius: 20px; padding: 20px;">
                <button class="nav-btn" onclick="closeForum()" style="margin-bottom:15px; width:auto; display:inline-flex; background:rgba(255,255,255,0.1); color:white;">‚¨Ö INDIETRO</button>
                <h3 style="color: var(--accent); text-align: center; margin-bottom: 20px;">üìù CANDIDATURA STAFF</h3>
                <div class="panel" style="max-width:600px; margin:0 auto; background: rgba(0,0,0,0.3);">
                    <form name="candidature" method="POST" data-netlify="true">
                        <input type="hidden" name="form-name" value="candidature" />
                        
                        <label style="display:block; text-align:left; color:#ccc; margin-bottom:5px;">Nome in Gioco (IGN)</label>
                        <input type="text" name="ign" placeholder="Es. Steve123" required>
                        
                        <label style="display:block; text-align:left; color:#ccc; margin-bottom:5px;">La tua Et√†</label>
                        <input type="number" name="age" placeholder="Es. 16" required>
                        
                        <label style="display:block; text-align:left; color:#ccc; margin-bottom:5px;">Tag Discord</label>
                        <input type="text" name="discord_tag" placeholder="Es. utente#0000" required>
                        
                        <label style="display:block; text-align:left; color:#ccc; margin-bottom:5px;">Ruolo Desiderato</label>
                        <select name="role" required>
                            <option value="" disabled selected>-- Seleziona Ruolo --</option>
                            <option value="Helper">Helper</option>
                            <option value="Builder">Builder</option>
                            <option value="Developer">Developer</option>
                            <option value="Media">Media / YouTuber</option>
                        </select>

                        <label style="display:block; text-align:left; color:#ccc; margin-bottom:5px;">Perch√© dovremmo sceglierti?</label>
                        <textarea name="why" placeholder="Raccontaci di te..." rows="5" required></textarea>
                        
                        <button type="submit" class="btn-action">INVIA CANDIDATURA</button>
                    </form>
                </div>
            </div>

            <div id="sub-report" class="sub-forum page" style="background: var(--glass-dark); border-radius: 20px; padding: 20px;">
                <button class="nav-btn" onclick="closeForum()" style="margin-bottom:15px; width:auto; display:inline-flex; background:rgba(255,255,255,0.1); color:white;">‚¨Ö INDIETRO</button>
                <h3 style="color: var(--error); text-align: center; margin-bottom: 20px;">üö® SEGNALA UN UTENTE</h3>
                <div class="panel" style="max-width:600px; margin:0 auto; background: rgba(0,0,0,0.3);">
                    <form name="segnalazioni" method="POST" data-netlify="true">
                        <input type="hidden" name="form-name" value="segnalazioni" />
                        
                        <label style="display:block; text-align:left; color:#ccc; margin-bottom:5px;">Nome del Player da Segnalare</label>
                        <input type="text" name="player_target" placeholder="Es. Cheater123" required>
                        
                        <label style="display:block; text-align:left; color:#ccc; margin-bottom:5px;">Link Prove (Video/Foto)</label>
                        <input type="text" name="proof_link" placeholder="Es. Link Imgur o YouTube" required>
                        
                        <label style="display:block; text-align:left; color:#ccc; margin-bottom:5px;">Descrizione Accaduto</label>
                        <textarea name="motivo" placeholder="Descrivi cosa √® successo..." rows="4" required></textarea>
                        
                        <button type="submit" class="btn-action" style="background: linear-gradient(to bottom, #ff5555, #cc0000); border-bottom-color: #990000;">INVIA REPORT</button>
                    </form>
                </div>
            </div>

            <div id="sub-news" class="sub-forum page" style="background: var(--glass-dark); border-radius: 20px; padding: 20px;">
                <button class="nav-btn" onclick="closeForum()" style="margin-bottom:15px; background:rgba(255,255,255,0.1); color:white;">‚¨Ö INDIETRO</button>
                <h3>üì∞ NEWS</h3>
                <div id="news-feed" style="margin-top:20px;"><p>Nessuna news recente.</p></div>
            </div>
        </div>

        <div id="p-staff" class="page"><div class="panel"><h2>IL TEAM</h2><div class="clean-grid" id="staff-grid"></div></div></div>
        
        <div id="p-rules" class="page">
            <div class="panel" style="text-align: left; max-width: 800px; margin: 0 auto;">
                <h2 style="text-align: center; margin-bottom: 30px;">REGOLAMENTO</h2>
                <div class="rules-category">
                    <h3><i class="fab fa-discord"></i> REGOLAMENTO DISCORD</h3>
                    <div class="rule-item"><i class="fas fa-ban rule-icon"></i> Non Spammare in Chat Pubblica.</div>
                    <div class="rule-item"><i class="fas fa-robot rule-icon"></i> Non utilizzare Applicazioni esterne non autorizzate.</div>
                    <div class="rule-item"><i class="fas fa-volume-mute rule-icon"></i> Non Bestemmiare o dire Parolacce in Chat o in Voc.</div>
                    <div class="rule-item"><i class="fas fa-fire rule-icon"></i> Non Flamare.</div>
                    <div class="rule-item"><i class="fas fa-ad rule-icon"></i> Non Spammare il tuo Server.</div>
                    <div class="rule-item"><i class="fas fa-user-secret rule-icon"></i> Non Impersonare lo Staff.</div>
                    <div class="rule-item"><i class="fas fa-user-lock rule-icon"></i> Non Divulgare dati Personali.</div>
                    <div class="rule-item"><i class="fas fa-bell-slash rule-icon"></i> Non Pingare lo Staff.</div>
                    <div class="rule-item"><i class="fas fa-music rule-icon"></i> Non Spammare SoundBar.</div>
                    <div class="rule-item"><i class="fas fa-exclamation-triangle rule-icon"></i> Non Minacciare Utenti o Staff.</div>
                </div>
                <div class="rules-category">
                    <h3><i class="fas fa-cube"></i> REGOLAMENTO MINECRAFT</h3>
                    <div class="rule-item"><i class="fas fa-ban rule-icon" style="color:red;"></i> Non usare Cheat.</div>
                    <div class="rule-item"><i class="fas fa-eye-slash rule-icon"></i> Non usare X-Ray.</div>
                    <div class="rule-item"><i class="fas fa-door-open rule-icon"></i> Non Ban Evadere.</div>
                    <div class="rule-item"><i class="fas fa-globe rule-icon"></i> Non usare VPN.</div>
                    <div class="rule-item"><i class="fas fa-wifi rule-icon"></i> Non Tentare un Doxing/DDoS.</div>
                    <div class="rule-item"><i class="fas fa-bomb rule-icon"></i> Non Nukkare.</div>
                    <div class="rule-item"><i class="fas fa-comments rule-icon"></i> Non Spammare in Chat.</div>
                    <div class="rule-item"><i class="fas fa-fire-alt rule-icon"></i> Non Flammare.</div>
                    <div class="rule-item"><i class="fas fa-heart-broken rule-icon"></i> Non Discriminare.</div>
                </div>
                <div style="text-align:center; margin-top:30px; border-top: 1px solid rgba(255,255,255,0.2); padding-top:20px;">
                    <h3 style="color: #4CAF50;">üéâ REGOLA EXTRA: DIVERTITI!</h3>
                    <p style="font-size: 0.8rem; color: #ccc; margin-top: 10px;">
                        Lo Staff di AnimalsMC si riserva di modificare durata o entit√† delle sanzioni in base alla situazione.<br>
                        Rispetta gli altri, gioca pulito e divertiti con noi!
                    </p>
                </div>
            </div>
        </div>

        <div id="p-discord" class="page">
            <div class="transparent-panel">
                <i class="fab fa-discord" style="font-size: 5rem; color: #5865F2; margin-bottom: 20px;"></i>
                <h2>DISCORD</h2>
                <button class="btn-action" onclick="window.open('https://discord.gg/er8n8apd69', '_blank')" style="max-width: 300px;">ENTRA ORA</button>
            </div>
        </div>
    </div>

    <footer class="site-footer">
        <p>Website developed by <span style="color: var(--sradmin); font-weight: bold;">Emi_xt11</span> &copy; 2025 AnimalsMC</p>
    </footer>

    <script>
        const staffData = {
            'RyanHaFame': { role: 'OWNER', color: 'var(--owner)' },
            'ItzMatto_': { role: 'OWNER', color: 'var(--owner)' },
            'Ginofakenews': { role: 'OWNER', color: 'var(--owner)' },
            'Emi_xt11': { role: 'SR ADMIN', color: 'var(--sradmin)' },
            'Leopardy90': { role: 'ADMIN', color: 'var(--admin)' },
            'LX_Light': { role: 'MANAGER', color: 'var(--manager)' },
            'Aishimc_': { role: 'JR MOD', color: 'var(--jrmod)' },
            'Simonefandomi': { role: 'HELPER', color: 'var(--helper)' },
            'DiegoIlProYT': { role: 'TRAINEE', color: 'var(--trainee)' },
            'ninjaluca111': { role: 'TRAINEE', color: 'var(--trainee)' },
            'MRdream20033': { role: 'TRAINEE', color: 'var(--trainee)' },
            'rex_quello_fiero': { role: 'TRAINEE', color: 'var(--trainee)' }
        };

        function toggleMenu() { document.getElementById('nav-links').classList.toggle('mobile-active'); }

        // NETLIFY IDENTITY
        let currentUser = null;
        if (window.netlifyIdentity) {
            window.netlifyIdentity.on("init", user => { if (user) loginUser(user); });
            window.netlifyIdentity.on("login", user => { loginUser(user); window.netlifyIdentity.close(); });
            window.netlifyIdentity.on("logout", () => { logoutUser(); });
        }
        function loginUser(user) {
            currentUser = user.user_metadata.full_name || user.email;
            document.getElementById('n-register').style.display = 'none'; 
            document.getElementById('n-login').style.display = 'none'; 
            document.getElementById('n-logout').style.display = 'flex';
            document.getElementById('nav-user-display').style.display = 'flex'; 
            document.getElementById('nav-username').innerText = currentUser; 
            document.getElementById('nav-user-head').src = `https://mc-heads.net/avatar/Steve/50`; 
        }
        function logoutUser() {
            currentUser = null;
            document.getElementById('n-register').style.display = 'flex'; 
            document.getElementById('n-login').style.display = 'flex'; 
            document.getElementById('n-logout').style.display = 'none'; 
            document.getElementById('nav-user-display').style.display = 'none';
            nav('home');
        }

        // NAVIGAZIONE
        function nav(p) {
            document.getElementById('nav-links').classList.remove('mobile-active');
            if (p === 'forum') { closeForum(); } 
            else { document.querySelectorAll('.sub-forum').forEach(e => e.classList.remove('active')); }
            
            document.querySelectorAll('.page').forEach(e => e.classList.remove('active'));
            const pageEl = document.getElementById('p-' + p);
            if(pageEl) pageEl.classList.add('active');

            document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
            const btn = document.getElementById('n-' + p); 
            if(btn) btn.classList.add('active');
            
            if (p === 'staff') loadStaff();
            if (p === 'store') loadStore();
        }

        // FORUM LOGIC
        function openForum(id) {
            document.getElementById('forum-hub').parentElement.classList.remove('active'); // Nascondi il Forum Hub principale
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active')); // Assicurati che altre pagine siano chiuse
            document.getElementById('p-forum').classList.add('active'); // Mantieni attivo il contenitore padre
            
            const sub = document.getElementById('sub-'+id);
            if(sub) {
                sub.classList.add('active');
                sub.style.display = 'block'; // Forza display block per sicurezza
            }
        }
        function closeForum() {
            document.querySelectorAll('.sub-forum').forEach(e => {
                e.classList.remove('active');
                e.style.display = 'none';
            });
            document.getElementById('forum-hub').style.display = 'block'; // Mostra di nuovo l'hub
            document.getElementById('p-forum').classList.add('active');
        }

        function copyIp() { navigator.clipboard.writeText('play.animalsmc.it'); alert('IP Copiato: play.animalsmc.it'); }

        function checkServerStatus() {
            fetch(`https://api.mcsrvstat.us/2/play.animalsmc.it`).then(r => r.json()).then(d => {
                const txt = document.getElementById('server-status-text');
                const dot = document.getElementById('status-dot');
                const count = document.getElementById('player-count');
                if (d.online) {
                    txt.innerText = "ONLINE"; txt.style.color = "#4CAF50";
                    dot.className = "status-indicator status-online";
                    count.innerText = d.players ? d.players.online : "0";
                } else {
                    txt.innerText = "OFFLINE"; txt.style.color = "#ff5555";
                    dot.className = "status-indicator status-offline";
                }
            }).catch(() => {});
        }
        setInterval(checkServerStatus, 60000); checkServerStatus();

        function loadStaff() {
            const grid = document.getElementById('staff-grid'); grid.innerHTML = '';
            const rolesOrder = ['OWNER', 'MANAGER', 'SR ADMIN', 'ADMIN', 'JR DEV', 'JR MOD', 'HELPER', 'TRAINEE'];
            Object.keys(staffData).sort((a,b) => rolesOrder.indexOf(staffData[a].role) - rolesOrder.indexOf(staffData[b].role))
            .forEach(name => {
                const s = staffData[name];
                grid.innerHTML += `<div class="item-card"><img src="https://mc-heads.net/avatar/${name}/100" class="staff-img"><h3 style="color:${s.color}; font-size:1rem;">${name}</h3><div style="background:${s.color}; padding:3px 8px; border-radius:5px; font-size:0.7rem; margin-top:5px; font-weight:bold;">${s.role}</div></div>`;
            });
        }
        function loadStore() {
            const items = [{n:'VIP',p:500},{n:'VIP+',p:1000},{n:'MVP',p:2000},{n:'Unban',p:5000}];
            document.getElementById('store-grid').innerHTML = items.map(i => `<div class="item-card"><h3>${i.n}</h3><p>${i.p} Coins</p><button class="btn-action" onclick="alert('Store disponibile presto!')">COMPRA</button></div>`).join('');
        }
        function checkCoins() {
            const u = document.getElementById('coin-user').value; if(!u) return;
            let h=0; for(let i=0;i<u.length;i++)h=u.charCodeAt(i)+((h<<5)-h);
            const c = Math.abs(h%5000);
            document.getElementById('coin-result').style.display='block';
            document.getElementById('coin-name').innerText=u;
            document.getElementById('coin-amount').innerText=c;
            document.getElementById('coin-skin').src=`https://mc-heads.net/avatar/${u}/60`;
        }

        setInterval(() => {
            const l = document.createElement('div'); l.innerText = 'üçÉ'; l.className='real-leaf';
            l.style.left = Math.random()*100+'vw'; l.style.animation = `leafFall ${Math.random()*5+5}s linear`;
            document.getElementById('leaves-container').appendChild(l);
            setTimeout(()=>l.remove(), 10000);
        }, 2000);
    </script>
</body>
</html>